
import tkinter as tk
from PIL import Image, ImageDraw

saved_files = []   # ì €ì¥ëœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸

CANVAS_WIDTH = 600
CANVAS_HEIGHT = 400

class PaintApp:
    def __init__(self, root):
        self.root = root
        self.root.title("ê·¸ë¦¼ ê·¸ë¦¬ê¸° í”„ë¡œê·¸ë¨")

        # ====== ì €ì¥í•  ì¥ìˆ˜ ì…ë ¥ë€ ======
        frame = tk.Frame(root)
        frame.pack(pady=5)

        tk.Label(frame, text="ëª‡ ì¥ ì €ì¥í• ê¹Œìš”?").pack(side="left")
        self.num_entry = tk.Entry(frame, width=5)
        self.num_entry.pack(side="left")
        self.num_entry.insert(0, "1")

        self.current_count = 0  # í˜„ì¬ê¹Œì§€ ì €ì¥ëœ ê·¸ë¦¼ ìˆ˜

        # ====== ìº”ë²„ìŠ¤ ë§Œë“¤ê¸° ======
        self.canvas = tk.Canvas(root, bg="white", width=CANVAS_WIDTH, height=CANVAS_HEIGHT)
        self.canvas.pack()

        # ====== ì‹¤ì œ ì´ë¯¸ì§€ ë²„í¼ ë§Œë“¤ê¸° (Pillow) ======
        self.image = Image.new("RGB", (CANVAS_WIDTH, CANVAS_HEIGHT), "white")
        self.draw = ImageDraw.Draw(self.image)

        # ====== ê·¸ë¦¬ê¸° ì´ë²¤íŠ¸ ======
        self.last_x, self.last_y = None, None
        self.canvas.bind("<ButtonPress-1>", self.start_draw)
        self.canvas.bind("<B1-Motion>", self.draw_line)

        # ====== ì €ì¥ ë²„íŠ¼ ======
        self.save_button = tk.Button(root, text="ì´ ê·¸ë¦¼ ì €ì¥í•˜ê¸°", command=self.save_one_image)
        self.save_button.pack(pady=10)

    def reset_image(self):
        """Pillow ì´ë¯¸ì§€ ë²„í¼ë„ ì´ˆê¸°í™”"""
        self.image = Image.new("RGB", (CANVAS_WIDTH, CANVAS_HEIGHT), "white")
        self.draw = ImageDraw.Draw(self.image)

    def start_draw(self, event):
        self.last_x, self.last_y = event.x, event.y

    def draw_line(self, event):
        # Tkinter ìº”ë²„ìŠ¤ì— ì„  ê·¸ë¦¬ê¸°
        self.canvas.create_line(self.last_x, self.last_y, event.x, event.y, fill="black", width=3)

        # Pillow ì´ë¯¸ì§€ì—ë„ ë™ì¼í•œ ì„  ê·¸ë¦¬ê¸°
        self.draw.line((self.last_x, self.last_y, event.x, event.y), fill="black", width=3)

        self.last_x, self.last_y = event.x, event.y

    def save_one_image(self):
        total = int(self.num_entry.get())

        if self.current_count >= total:
            return

        self.current_count += 1
        filename = f"drawing_{self.current_count}.jpg"

        # ====== ì‹¤ì œ ì´ë¯¸ì§€ ì €ì¥ ======
        self.image.save(filename, "JPEG")
        saved_files.append(filename)
        print(f"{filename} ì €ì¥ ì™„ë£Œ!")

        # ====== ìº”ë²„ìŠ¤ & ì´ë¯¸ì§€ ì´ˆê¸°í™” ======
        self.canvas.delete("all")
        self.reset_image()

        # ====== ì¢…ë£Œ ì¡°ê±´ ======
        if self.current_count == total:
            print("\nğŸ‰ ëª¨ë“  ê·¸ë¦¼ ì €ì¥ ì™„ë£Œ!")
            print("ì €ì¥ëœ íŒŒì¼ë“¤:", saved_files)
            self.root.destroy()   # í”„ë¡œê·¸ë¨ ì¢…ë£Œ


# ì‹¤í–‰
root = tk.Tk()
app = PaintApp(root)
root.mainloop()
